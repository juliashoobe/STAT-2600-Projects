---
output:
  pdf_document: default
  html_document: default
editor_options:
  chunk_output_type: console
---
 ---
title: "Final Project"
author: "Julia Shoobe"
date: "11/14/2020"
output: html_document
editor_options: 
  chunk_output_type: inline
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
#Install Dataset
```{r}
data <- read.csv("/cloud/project/FINAL PROJECT DATA 2.csv")
```

#Install and Load Packages
```{r}
#install.packages("tidyverse") #install once, then comment out
library(tidyverse)
```

#Convert Data Types
```{r}
#Convert to Numeric
as.numeric(data$Mood.Ranking..1.10.)
as.numeric(data$Heart.Rate)
as.numeric(data$Age)
as.numeric(data$Alcohol.Tobacco.Hard.Drug.Usage..1.10.)
as.numeric(data$B12.Level)
as.numeric(data$Vitamin.D.Level)

#Convert to Character
as.character(data$Overall.Feeling)
as.character(data$Diagnosis)
as.character(data$Overall.Health)
as.character(data$Other.Medical.Conditions)

#Convert to Logical
as.logical(data$Suicidal.Thoughts.Attempts...Yes.No)
```

# Diagnosis Subsets
```{r}
anxietydata <- filter(data, Diagnosis == "Generalized Anxiety Disorder")
depressiondata <- filter(data, Diagnosis == "Major Depression")
bipolardata <- filter(data, Diagnosis == "Bipolar Disorder")
adhddata <- filter(data, Diagnosis == "Attention Deficit Hyperactivity Disorder (ADHD)")
```

#Suicide Subsets
```{r}
yessuicide <- filter(data, Suicidal.Thoughts.Attempts...Yes.No == "Yes")
nosuicide <- filter(data, Suicidal.Thoughts.Attempts...Yes.No == "No")
anxietyyes <- filter(anxietydata, Suicidal.Thoughts.Attempts...Yes.No == "Yes")
anxietyno <- filter(anxietydata, Suicidal.Thoughts.Attempts...Yes.No == "No")
depressionyes <- filter(depressiondata, Suicidal.Thoughts.Attempts...Yes.No == "Yes")
depressionno <- filter(depressiondata, Suicidal.Thoughts.Attempts...Yes.No == "No")
bipolaryes <- filter(bipolardata, Suicidal.Thoughts.Attempts...Yes.No == "Yes")
bipolarno <- filter(bipolardata, Suicidal.Thoughts.Attempts...Yes.No == "No")
adhdyes <- filter(adhddata, Suicidal.Thoughts.Attempts...Yes.No == "Yes")
adhdno <- filter(adhddata, Suicidal.Thoughts.Attempts...Yes.No == "No")
```

#Mood Subsets
```{r}
goodmooddata <- filter(data, Mood.Ranking..1.10. > 5)
badmooddata <- filter(data, Mood.Ranking..1.10. <= 5)
goodanxiety <- filter(anxietydata, Mood.Ranking..1.10. > 5)
badanxiety <- filter(anxietydata, Mood.Ranking..1.10. <= 5)
gooddepression <- filter(depressiondata, Mood.Ranking..1.10. > 5)
baddepression <- filter(depressiondata, Mood.Ranking..1.10. <= 5)
goodbipolar <- filter(bipolardata, Mood.Ranking..1.10. > 5)
badbipolar <- filter(bipolardata, Mood.Ranking..1.10. <= 5)
goodadhd <- filter(adhddata, Mood.Ranking..1.10. > 5)
badadhd <- filter(adhddata, Mood.Ranking..1.10. <=5)
yesgood <- filter(yessuicide, Mood.Ranking..1.10. > 5)
yesbad <- filter(yessuicide, Mood.Ranking..1.10. <= 5)
nogood <- filter(nosuicide, Mood.Ranking..1.10. > 5)
nobad <- filter(nosuicide, Mood.Ranking..1.10. <= 5)
```

#Age Subsets
```{r}
youngdata <- filter(data, Age < 50)
olddata <- filter(data, Age >= 50)
```

#Tobacco Subsets
```{r}
tobaccohigh <- filter(data, Alcohol.Tobacco.Hard.Drug.Usage..1.10. > 5)
tobaccolow <- filter(data, Alcohol.Tobacco.Hard.Drug.Usage..1.10. <= 5)
```

#Vitamin B12 Subsets
```{r}
lowB12 <- filter(data, B12.Level < 250)
normalB12 <- filter(data, B12.Level >= 250 && B12.Level <= 1230)
highB12 <- filter(data, B12.Level > 1230)
```

#Vitamin D Subsets
```{r}
lowD <- filter(data, Vitamin.D.Level < 40)
normalD <- filter(data, Vitamin.D.Level >= 40 && Vitamin.D.Level <= 90)
highD <- filter(data, Vitamin.D.Level > 90)
```

#Overall Feeling Subsets
```{r}
happy <- filter(data, Overall.Feeling == "happy/joyful/euphoric")
sad <- filter(data, Overall.Feeling == "sad/depressed/hopeless")
moody <- filter(data, Overall.Feeling == "moody/irritable")
relaxed <- filter(data, Overall.Feeling == "relaxed/content")
stressed <- filter(data, Overall.Feeling == "stressed/restless/anxious")

happyanxiety <- filter(anxietydata, Overall.Feeling == "happy/joyful/euphoric")
sadanxiety <- filter(anxietydata, Overall.Feeling == "sad/depressed/hopeless")
moodyanxiety <- filter(anxietydata, Overall.Feeling == "moody/irritable")
relaxedanxiety <- filter(anxietydata, Overall.Feeling == "relaxed/content")
stressedanxiety <- filter(anxietydata, Overall.Feeling == "stressed/restless/anxious")

happydepressed <- filter(depressiondata, Overall.Feeling == "happy/joyful/euphoric")
saddepressed <- filter(depressiondata, Overall.Feeling == "sad/depressed/hopeless")
moodydepressed <- filter(depressiondata, Overall.Feeling == "moody/irritable")
relaxeddepressed <- filter(depressiondata, Overall.Feeling == "relaxed/content")
stresseddepressed <- filter(depressiondata, Overall.Feeling == "stressed/restless/anxious")

happybipolar <- filter(bipolardata, Overall.Feeling == "happy/joyful/euphoric")
sadbipolar <- filter(bipolardata, Overall.Feeling == "sad/depressed/hopeless")
moodybipolar <- filter(bipolardata, Overall.Feeling == "moody/irritable")
relaxedbipolar <- filter(bipolardata, Overall.Feeling == "relaxed/content")
stressedbipolar <- filter(bipolardata, Overall.Feeling == "stressed/restless/anxious")

happyadhd <- filter(adhddata, Overall.Feeling == "happy/joyful/euphoric")
sadadhd <- filter(adhddata, Overall.Feeling == "sad/depressed/hopeless")
moodyadhd <- filter(adhddata, Overall.Feeling == "moody/irritable")
relaxedadhd <- filter(adhddata, Overall.Feeling == "relaxed/content")
stressedadhd <- filter(adhddata, Overall.Feeling == "stressed/restless/anxious")
```

#Bar Chart Showing Number of Subjects Feeling a Certain Way Given Diagnosis
```{r}
feeling <- ggplot(data = data)+
  geom_bar(mapping = aes(x = Diagnosis, fill = Overall.Feeling)) +
  ggtitle("Figure 1: Overall Feeling") +
  ylab("Number of Subjects") +
  labs(fill = "Overall Feeling Description")+
  theme(text = element_text(size = 10))           
feeling
```

#Vitamin B12
```{r}
#**Means of Disorders and B12**
mean(anxietydata$B12.Level)
#408.17
mean(adhddata$B12.Level)
#720.44
mean(depressiondata$B12.Level)
#452.66
mean(bipolardata$B12.Level)
#402.83
mean(data$B12.Level)
#496.74

#**Medians of Disorders and B12**
median(anxietydata$B12.Level)
#347
median(adhddata$B12.Level)
#677
median(depressiondata$B12.Level)
#369.5
median(bipolardata$B12.Level)
#306
median(data$B12.Level)
#393.5

#Boxplot of B12 Level Based on Diagnosis
b12box<-ggplot(data = data, mapping = aes(x = Diagnosis, y = B12.Level)) +
  geom_boxplot() +
  ggtitle("Figure 2: B12 Level Based on Diagnosis") +
  ylab("B12 Level") +
  theme(text = element_text(size = 10))           
b12box

#Does Age Affect B12?
ageb12 <- ggplot(data = data, mapping = aes(x = Age, y = B12.Level)) + 
  geom_point() + 
  geom_smooth() +
  facet_wrap(~Diagnosis)
ageb12

#Does Heart Rate Affect B12?
hrb12 <- ggplot(data = data, mapping = aes(x=Heart.Rate, y = B12.Level)) +
  geom_point()+
  geom_smooth()+
  facet_wrap(~Diagnosis)
hrb12
```

#Tobacco and B12
```{r}
#Mean Data per Diagnosis
mean(anxietydata$Alcohol.Tobacco.Hard.Drug.Usage..1.10.)
#6.32
mean(depressiondata$Alcohol.Tobacco.Hard.Drug.Usage..1.10.)
#5.96
mean(bipolardata$Alcohol.Tobacco.Hard.Drug.Usage..1.10.)
#6.86
mean(adhddata$Alcohol.Tobacco.Hard.Drug.Usage..1.10.)
#5.52

b12tobaccodiagnosis <- ggplot(data, aes(x=Alcohol.Tobacco.Hard.Drug.Usage..1.10., y=B12.Level, fill = Diagnosis)) + 
  stat_summary(geom ='bar', fun = mean, position=position_dodge(.5))+
  ylab("B12 Level")+
  xlab("Addictive Substance Usage (1-10)")+
  ggtitle("Figure 3: B12 Levels and Substance Usage
          - per Diagnosis")
b12tobaccodiagnosis 
```


#Vitamin D
```{r}
#**Means of Vitamin D Per Diagnosis**
mean(anxietydata$Vitamin.D.Level)
#44.67
mean(adhddata$Vitamin.D.Level)
#57.80
mean(depressiondata$Vitamin.D.Level)
#41.31
mean(bipolardata$Vitamin.D.Level)
#30.41
mean(data$Vitamin.D.Level)
#

#**Medians of Vitamin D Per Diagnosis**
median(anxietydata$Vitamin.D.Level)
#35
median(adhddata$Vitamin.D.Level)
#57
median(depressiondata$Vitamin.D.Level)
#35.5
median(bipolardata$Vitamin.D.Level)
#36
median(data$Vitamin.D.Level)
#39

#Boxplot of Vitamin D Level Based on Diagnosis
dbox<-ggplot(data = data, mapping = aes(x = Diagnosis, y = Vitamin.D.Level)) +
  geom_boxplot() +
  ggtitle("Figure 4: Vitamin D Level Based on Diagnosis") +
  ylab("Vitamin D Level") +
  theme(text = element_text(size = 10))           
dbox

#Does Age Affect Vitamin D?
aged <- ggplot(data = data, mapping = aes(x = Age, y = Vitamin.D.Level)) + 
  geom_point() + 
  geom_smooth() +
  facet_wrap(~Diagnosis)
aged

#Does Heart Rate Affect Vitamin D?
hrd <- ggplot(data = data, mapping = aes(x=Heart.Rate, y = Vitamin.D.Level)) +
  geom_point()+
  geom_smooth()+
  facet_wrap(~Diagnosis)+
hrd
```



